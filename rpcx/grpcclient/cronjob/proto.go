// GENERATED BY THE COMMAND ABOVE; DO NOT EDIT
// This file was generated by grpc_generate_tools(grpcgengo) at
//
package cronjob

import (
	"context"

	jsoniter "github.com/json-iterator/go"
	"gitlab.flyele.vip/server-side/go-zero/v2/rpcx/grpcbase"
)

var (
	CreateCronJobHandler func(ctx context.Context, req CreateCronJobRequest) grpcbase.Response
	DeleteCronJobHandler func(ctx context.Context, req DeleteCronJobRequest) grpcbase.Response
	GetCronJobHandler    func(ctx context.Context, req GetCronJobRequest) grpcbase.Response
)

type Repository interface {
	CreateCronJob(ctx context.Context, request CreateCronJobRequest) grpcbase.Response
	DeleteCronJob(ctx context.Context, request DeleteCronJobRequest) grpcbase.Response
	GetCronJob(ctx context.Context, request GetCronJobRequest) grpcbase.Response
}

type Any struct {
	type_url string `json:"type_url,omitempty"`
	value    []byte `json:"value,omitempty"`
}

func (s Any) String() string {
	b, _ := jsoniter.Marshal(s)
	return string(b)
}

type CreateCronJobRequest struct {
	Schedule        string            `json:"schedule,omitempty"`
	Code            int32             `json:"code,omitempty"`
	RefTaskID       string            `json:"ref_task_id,omitempty"`
	ExecuteMetadata map[string]string `json:"execute_metadata,omitempty"`
	Context         *UserContext      `json:"context,omitempty"`
}

func (s CreateCronJobRequest) String() string {
	b, _ := jsoniter.Marshal(s)
	return string(b)
}

type CreateCronJobResponse struct {
	JobID string `json:"job_id,omitempty"`
}

func (s CreateCronJobResponse) String() string {
	b, _ := jsoniter.Marshal(s)
	return string(b)
}

type DeleteCronJobRequest struct {
	FlyeleID string       `json:"flyele_id,omitempty"`
	Code     int32        `json:"code,omitempty"`
	Context  *UserContext `json:"context,omitempty"`
}

func (s DeleteCronJobRequest) String() string {
	b, _ := jsoniter.Marshal(s)
	return string(b)
}

type GetCronJobRequest struct {
	FlyeleID string       `json:"flyele_id,omitempty"`
	Code     int32        `json:"code,omitempty"`
	Context  *UserContext `json:"context,omitempty"`
}

func (s GetCronJobRequest) String() string {
	b, _ := jsoniter.Marshal(s)
	return string(b)
}

type Response struct {
	Message string `json:"message,omitempty"`
	Total   int32  `json:"total,omitempty"`
	Data    *Any   `json:"data,omitempty"`
}

func (s Response) String() string {
	b, _ := jsoniter.Marshal(s)
	return string(b)
}

type UserContext struct {
	UserID        string `json:"user_id,omitempty"`
	Platform      string `json:"platform,omitempty"`
	ClientVersion string `json:"client_version,omitempty"`
	Token         string `json:"token,omitempty"`
	ClientIP      string `json:"client_ip,omitempty"`
	RequestID     string `json:"request_id,omitempty"`
}

func (s UserContext) String() string {
	b, _ := jsoniter.Marshal(s)
	return string(b)
}

type service struct{}

// RpcContextFromHeader 从 httprouter.Context转换为grpc中所需的用户上下文
func RpcContextFromHeader(header string) *UserContext {
	var ctx *UserContext
	_ = jsoniter.UnmarshalFromString(header, ctx)
	return ctx
}

//NewService 新建cronjob的grpc服务
func NewService() Repository {
	return service{}
}

func (s service) CreateCronJob(ctx context.Context, req CreateCronJobRequest) grpcbase.Response {
	if CreateCronJobHandler != nil {
		if req.Context == nil {
			panic("grpc context is nil and requestID must be set")
		}
		return grpcbase.RPCServerSideLogic("/pb.cronjob/CreateCronJob", req.Context.RequestID, req, func(ctx context.Context, req interface{}) grpcbase.Response {
			return CreateCronJobHandler(ctx, req.(CreateCronJobRequest))
		})
	}
	return grpcbase.NotImplErrorResponse
}

func (s service) DeleteCronJob(ctx context.Context, req DeleteCronJobRequest) grpcbase.Response {
	if DeleteCronJobHandler != nil {
		if req.Context == nil {
			panic("grpc context is nil and requestID must be set")
		}
		return grpcbase.RPCServerSideLogic("/pb.cronjob/DeleteCronJob", req.Context.RequestID, req, func(ctx context.Context, req interface{}) grpcbase.Response {
			return DeleteCronJobHandler(ctx, req.(DeleteCronJobRequest))
		})
	}
	return grpcbase.NotImplErrorResponse
}

func (s service) GetCronJob(ctx context.Context, req GetCronJobRequest) grpcbase.Response {
	if GetCronJobHandler != nil {
		if req.Context == nil {
			panic("grpc context is nil and requestID must be set")
		}
		return grpcbase.RPCServerSideLogic("/pb.cronjob/GetCronJob", req.Context.RequestID, req, func(ctx context.Context, req interface{}) grpcbase.Response {
			return GetCronJobHandler(ctx, req.(GetCronJobRequest))
		})
	}
	return grpcbase.NotImplErrorResponse
}
